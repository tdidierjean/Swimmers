var regenerateFood = true;
var screenWidth = 800;
var screenHeight = 800;
var waterMaskPtrn = null;
var waterPtrn = null;
var intervalId = null;
var genTime = 2000;
var fastMode = false;
var generation = 0;
var totalFitness = 0;
var maxFitness = 0;
var minFitness = 0;
var dataHistory = new Array();
var numPlankton = 100;
var numFish = 30;
var fishes = new Array();
var plankton = new kdtree([]);
var foodImg = new Image();

var tile_water_data = "data:image/png;base64,\
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\
0r/2a/YZ3/x6g71axgNRg37OnSftP//Z";

var tile_aqua_data = "data:image/png;base64,\
/9j/4AAQSkZJRgABAQEASABIAAD/2wBDAAIBAQIBAQICAgICAgICAwUDAwMDAwYEBAMFBwYHBwcG\
BwcICQsJCAgKCAcHCg0KCgsMDAwMBwkODw0MDgsMDAz/2wBDAQICAgMDAwYDAwYMCAcIDAwMDAwM\
DAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAz/wAARCABeAF4DAREA\
AhEBAxEB/8QAHAAAAwEBAQEBAQAAAAAAAAAABAUGAwIBAAcJ/8QAOBAAAQMCBQMDAgMGBgMAAAAA\
AQIDBAURAAYSITETQVEHInEUYTKBoRUjkbHR4RYkM0JS8TRi8P/EABoBAAMBAQEBAAAAAAAAAAAA\
AAIDBAEFAAf/xAAuEQACAgEEAgAGAAYDAQAAAAABAgADEQQSITEiQQUTFDJRcSNCYYGxwTNSoZH/\
2gAMAwEAAhEDEQA/AP6AVfL9NYlpL1QRKS0NLfRHtCb9j2O2/fH3eq+zadq4J/M+Y2KueJuuVRYV\
NS+8qQWlEoSEAXURa4BPNgcCBczbV7mBRjM1h+p0ZIch0iAmEHUqT11Ku8rY8W43+MLfQOWD3NkC\
MFoUYSfZDmws0SV06rSSpqVqCS6bFKwdtzvz5OD1qvSotpHU9Th+Hntd9Ln6HKQkoWEKSSne4O5v\
x9rH88BT8QWxc9Qmo2xe36eVGewXGmFaVHT1FEJQD8njDvrUU8n+0A0lowzDSnMm02nwXEKcSn96\
VoIPVXbYC3xbbnCqbVucv1PNUVGJszTq45lSXKYiyh1h1Fe38Ke5t2232GBa2kWBWIHM012FciIX\
1SJ8GMyr92GUqUoquTcm1zfxi1RWGJB7iSjlfKBw6C9WJ7bMbotpbJW46b6UjuTvvhr3Ki5mCvce\
ITX/AFFqNDS1TqXI6DTe6nI/tU+rufuPzxOukrtPzLRmE17LwkPpLyM20plqtyXhIi3UHJIJCtVt\
r8322+2EOhqb+CBgxqtlfPueQ5kifWmo9UQiUxKWEKWRYpF9yCO/JucMdVWsmvjEVuYt5w/MPqPS\
I9QZZNOZlUti7YbKQCgWAJSodzvhFOiu2F92GMdY6fjiS66OpGYI6oIDjMtYVHPYi4uFHtbvjobw\
aiG+7EnAycCfoWYqJl7JlMfmxy29UQn3aXdaEKO5IAtY3OOLRdqbmFb/AG/rmWmutF3KZEwvV2sQ\
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\
x6havIaf/9k=";